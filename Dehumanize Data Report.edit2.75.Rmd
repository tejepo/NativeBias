---
title: 'Dehumanization X Columbus Day/Indigenous Peoples Day'
author: "Terrence Pope"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    theme: spacelab
    highlight: zenburn
---

```{r setup,include=F}
knitr::opts_chunk$set(echo = F, warning = F, message = F)
library(haven)
library(tidyverse)
library(magrittr)
library(pander)
library(psych)
library(Hmisc)
library(reshape2)

#Creating a function that helps summarize data
summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
                      conf.interval=.95, .drop=TRUE) {
  library(plyr)
  
  # New version of length which can handle NA's: if na.rm==T, don't count them
  length2 <- function (x, na.rm=FALSE) {
    if (na.rm) sum(!is.na(x))
    else       length(x)
  }
  
  # This does the summary. For each group's data frame, return a vector with
  # N, mean, and sd
  datac <- plyr::ddply(data, groupvars, .drop=.drop,
                       .fun = function(xx, col) {
                         c(N    = length2(xx[[col]], na.rm=na.rm),
                           mean = mean   (xx[[col]], na.rm=na.rm),
                           sd   = sd     (xx[[col]], na.rm=na.rm)
                         )
                       },
                       measurevar
  )
  
  # Rename the "mean" column    
  datac <- plyr::rename(datac, c("mean" = measurevar))
  
  datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean
  
  # Confidence interval multiplier for standard error
  # Calculate t-statistic for confidence interval: 
  # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
  ciMult <- qt(conf.interval/2 + .5, datac$N-1)
  datac$ci <- datac$se * ciMult
  
  return(datac)
}

#load in data
path <- file.path("~/Desktop/UW/Summer '18/CultureColab/Native Bias/Data/Study_2_w_composites.sav")

studytwodata <- read_sav(path)

dfdehumanDV<- as.data.frame(cbind(studytwodata$Dehuman_wht_1,studytwodata$Dehuman_wht_2,studytwodata$Dehuman_wht_3,studytwodata$Dehuman_wht_4,studytwodata$Dehuman_wht_5,studytwodata$Dehuman_wht_6,studytwodata$Dehuman_wht_7,studytwodata$Dehuman_wht_8,studytwodata$Dehuman_wht_9,studytwodata$Dehuman_wht_10,studytwodata$Dehuman_wht_11,studytwodata$Dehuman_wht_12,studytwodata$Dehuman_wht_13,studytwodata$Dehuman_wht_14,studytwodata$Dehuman_wht_15,studytwodata$Dehuman_wht_16,studytwodata$Dehuman_wht_17,studytwodata$Dehuman_wht_18,studytwodata$Dehuman_wht_19,studytwodata$Dehuman_wht_20,studytwodata$Dehuman_Native_1,studytwodata$Dehuman_Native_2,studytwodata$Dehuman_Native_3,studytwodata$Dehuman_Native_4,studytwodata$Dehuman_Native_5,studytwodata$Dehuman_Native_6,studytwodata$Dehuman_Native_7,studytwodata$Dehuman_Native_8,studytwodata$Dehuman_Native_9,studytwodata$Dehuman_Native_10,studytwodata$Dehuman_Native_11,studytwodata$Dehuman_Native_12,studytwodata$Dehuman_Native_13,studytwodata$Dehuman_Native_14,studytwodata$Dehuman_Native_15,studytwodata$Dehuman_Native_16,studytwodata$Dehuman_Native_17,studytwodata$Dehuman_Native_18,studytwodata$Dehuman_Native_19,studytwodata$Dehuman_Native_20,studytwodata$DV1_4,studytwodata$DV1_5,

studytwodata$BorninUS,studytwodata$LengthState,studytwodata$FatherUSBorn,studytwodata$MotherUSBorn,studytwodata$PrimaryCaretaker,studytwodata$PrimaryEd,studytwodata$SecondCaretaker,studytwodata$SecondEdu,studytwodata$Religion,studytwodata$Religiosity,studytwodata$College,studytwodata$Year,studytwodata$Education,studytwodata$LibCon,studytwodata$SES,studytwodata$Race,studytwodata$StateNumeric,studytwodata$LongestRegion,studytwodata$SubjectNumber, studytwodata$EMP_comp, studytwodata$EMP_cent))




colnames(dfdehumanDV) <- c(V1 = "DH1_W_Responsible",V2 ="DH2_W_Civilized",V3 = "DH3_W_Moral",V4 = "DH4_W_Polite",
                           V5 = "DH5_W_Childlike",V6 = "DH6_W_Rational",V7 = "DH7_W_Warm",V8 = "DH8_W_Agentic",
                           V9 = "DH9_W_Refined",V10 = "DH10_W_Lacking_Culture",V11 = "DH11_W_Lacking_Self-restraint",V12 = "DH12_W_Instinctual",
                           V13 = "DH13_W_Mature",V14 = "DH14_W_Stoic",V15 = "DH15_W_Emotionally_Responsive",V16 = "DH16_W_Cold",
                           V17 = "DH17_W_Open",V18="DH18_W_Rigid",V19 =  "DH19_W_Passive",V20 = "DH20_W_Superficial",
                           V21 =  "DH1_N_Responsible",V22 = "DH2_N_Civilized",V23 = "DH3_N_Moral",V24 = "DH4_N_Polite",
                           V25 = "DH5_N_Childlike",V26 = "DH6_N_Rational",V27 = "DH7_N_Warm",V28 = "DH8_N_Agentic",
                           V29 =  "DH9_N_Refined",V30 = "DH10_N_Lacking_Culture",V31 = "DH11_N_Lacking_Self-restraint",V32 =  "DH12_N_Instinctual",
                           V33 = "DH13_N_Mature",V34 ="DH14_N_Stoic",V35 = "DH15_N_Emotionally_Responsive",V36 = "DH16_N_Cold",
                           V37 = "DH17_N_Open",V38 = "DH18_N_Rigid",V39 = "DH19_N_Passive",V40 =  "DH20_N_Superficial", 
                           V41 = "No_Columbus",V42 = "Create_IPD",V44 = "BorninUS",V45 = "LengthState",V46 = "FatherUSBorn", 
                           V48 = "MotherUSBorn",V49 = "PrimaryCaretaker",V50 = "PrimaryEd",V51 = "SecondCaretaker",V52 = "SecondEdu",
                           V53 = "Religion",V54 = "Religiosity",V55 = "College",V56 = "Year",V57 = "Education",V58 = "LibCon",V59 = "SES",
                           V60 = "Race",V61 = "StateNumeric",V62 = "LongestRegion",V63 = "SubjectNumber",V64 = "EMP_comp",V65 = "EMP_cent")

dfdehumanDV <- dfdehumanDV %>% 
  mutate(White_Dehumanize = rowMeans(dfdehumanDV[,1:20]))
dfdehumanDV <- dfdehumanDV %>% 
  mutate(Native_Dehumanize = rowMeans(dfdehumanDV[,21:40]))
dfdehumanDV <- dfdehumanDV %>%
  mutate(Age = as.numeric(studytwodata$Age))

dfdehumanDV$BorninUS <- factor(dfdehumanDV$BorninUS,
                               levels = c(0,1),
                               labels = c("No", "Yes"))
dfdehumanDV$FatherUSBorn <- factor(dfdehumanDV$FatherUSBorn,
                               levels = c(0,1,3),
                               labels = c("No", "Yes", "Unsure/Not applicable"))

dfdehumanDV$MotherUSBorn <- factor(dfdehumanDV$MotherUSBorn,
                               levels = c(0,1,3),
                               labels = c("No", "Yes", "Unsure/Not applicable"))

dfdehumanDV$PrimaryCaretaker <- factor(dfdehumanDV$PrimaryCaretaker,
                               levels = c(1,2,3,4,5,6,7),
                               labels = c("Mother", "Father", "Extended female family member (e.g., grandmother, aunt)", "Extended male family member (e.g., grandfather, uncle)", "Legal guardian female", "Legal guardian male", "Another caretaker (please describe):"))

dfdehumanDV$SecondCaretaker <- factor(dfdehumanDV$SecondCaretaker,
                               levels = c(1,2,3,4,5,6,7,8),
                               labels = c("No, I did not have another caretaker", "Mother", "Father", "Extended female family member (e.g., grandmother, aunt)", "Extended male family member (e.g., grandfather, uncle)", "Legal guardian female", "Legal guardian male", "Another caretaker (please describe):"))

dfdehumanDV$Religion <- factor(dfdehumanDV$Religion,
                               levels = c(1,2,3,4,5,6,7,8),
                               labels = c("None", "Catholic", "Christian (non Catholic)", "Jewish", "Muslim", "Buddhist", "Hindu", "Other (please specify):"))

dfdehumanDV$College <- factor(dfdehumanDV$College,
                               levels = c(1,2),
                               labels = c("Yes", "No"))

dfdehumanDV$SES <- factor(dfdehumanDV$SES,
                               levels = c(-1,1),
                               labels = c("No College", "College"))

dfdehumanDV$Race <- factor(dfdehumanDV$Race,
                               levels = c(1,2,3,4,5,6,7,8),
                               labels = c("Asian", "Black","White","Latino","Middle Eastern","Native","Other","Multiracial"))

dfdehumanDV$StateNumeric <- factor(dfdehumanDV$StateNumeric,
                               levels = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50),
                               labels = c("Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"))

dfdehumanDV$LongestRegion <- factor(dfdehumanDV$LongestRegion,
                               levels = c(1,2,3,4,5,6,7,8),
                               labels = c("New England","Mideast","Great Lakes","Plains","Southeast","Southwest","Rocky Mountain","Far West"))

destable <- as.data.frame(psych::describe(dfdehumanDV))
```
#Intro 

This is a data set that includes the following variables:

```{r names, include =T, echo=F}
variable.list <- as.matrix(names(dfdehumanDV))
pander(variable.list)
```
<br></br>
It's primary focus is to look a bit more closely at the dehumaniztion variables and how they interact not only with one another, but with the dependent variables (Columbus Day/Indigenous Peoples' Day (henceforth referred to as IPD)), as well as some of the demographic information gathered on the participants in this sample.

This sample comes from **Study Two**, so it is (*if I'm not mistaken*) a sample of participants gathered via *mturk*.

#Descriptives
First, lets take a look at a descriptives table of our variables. Keep in mind that some of the variables are categorical and are more difficult to interpret in a descriptives table.

```{r descriptives table, include =T, echo=F}
destable <- as.data.frame(cbind(destable[,2:5],destable[,13]))
table.names <- c("n", "mean", "sd", "median","se")
names(destable) <- table.names
pander(destable)
```

##Correlation of Civilized & Childlike for Natives

```{r whitenativedhcor, include =T, echo=F}
ggplot(dfdehumanDV, aes(x=DH2_N_Civilized, y = DH5_N_Childlike)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Civilized (Natives)") +
  ylab("Childlike (Natives)") +
  scale_y_continuous(limits = c(0, NA))


dehum.nw.cor <- cor.test(dfdehumanDV$DH2_N_Civilized, dfdehumanDV$DH5_N_Childlike, method = ("pearson"))

dehum.nw.cor
```

At baseline the two seem to be somewhat negatively correlated with scores clustering around the Natives as Civilized and childlike.

##Dependent Variables: Columbus Day X Dehumanization (Childlike)
Before we move on, let's take a gander at the dependent variables. Does there seem to be a relationship between dehumanization and *Support for getting rid of Columbus Day*? 

```{r dv4cor, include = T, echo = F}
dv4cor <- dfdehumanDV %>%
  dplyr::select(SubjectNumber, No_Columbus, DH5_W_Childlike, DH5_N_Childlike)

dv4cor.lng <- melt(dv4cor, id=c("SubjectNumber", "No_Columbus"), variable.name = "Group", value.name="Rating")

ggplot(dv4cor.lng, aes(x= Rating, y = No_Columbus, color = Group, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Dehumanization (0-100)") +
  ylab("Support for No Columbus Day") +
  labs(color='Dehumanized Group') +
  scale_y_continuous(limits = c(0, NA))

#lm1 <- lm(No_Columbus ~ Rating + Group + Rating:Group, dv4cor.lng)
#summary(lm1)
```
`**Keep in mind while looking at this graph that low scores on the dehumanization measure mean that participants are dehumanizing the group` **more**.


###Model: Abolish Columbus Day ~ Childlike Measures

Here is the Childlike model uncentered:
```{r}
lm10 <- lm(No_Columbus ~ DH5_N_Childlike + DH5_W_Childlike + DH5_N_Childlike*DH5_W_Childlike, dv4cor)
summary(lm10)
```

...and here it is centered:
```{r}
lm11 <- lm(No_Columbus ~ scale(DH5_N_Childlike,scale=F) + scale(DH5_W_Childlike,scale=F) + scale(DH5_N_Childlike,scale=F)*scale(DH5_W_Childlike,scale=F), dv4cor)
summary(lm11)
```


##Dependent Variables: Columbus Day X Dehumanization (Civilized)
Before we move on, let's take a gander at the dependent variables. Does there seem to be a relationship between dehumanization and *Support for getting rid of Columbus Day*? 

```{r dv4cor2, include = T, echo = F}
dv4cor2 <- dfdehumanDV %>%
  dplyr::select(SubjectNumber, No_Columbus, DH2_N_Civilized)

dv4cor2.lng <- melt(dv4cor2, id=c("SubjectNumber", "No_Columbus"), variable.name = "Group", value.name="Rating")

ggplot(dv4cor2.lng, aes(x= Rating, y = No_Columbus, color = Group, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Civilized") +
  ylab("Support for No Columbus Day") +
  labs(color='Dehumanized Measure') +
  scale_y_continuous(limits = c(0, NA))

#lm1 <- lm(No_Columbus ~ Rating + Group + Rating:Group, dv4cor.lng)
#summary(lm1)
```
`**Keep in mind while looking at this graph that low scores on the dehumanization measure mean that participants are dehumanizing the group` **more**.


###Model: Abolish Columbus Day ~ Civilized Measures

Here is the Civilized model uncentered:
```{r}
lm12 <- lm(No_Columbus ~ DH2_N_Civilized, dv4cor2)
summary(lm12)
```

...and here it is centered:
```{r}
lm13 <- lm(No_Columbus ~ scale(DH2_N_Civilized,scale=F), dv4cor2)
summary(lm13)
```


<br></br>

##Dependent Variables: Indigenous Peoples' Day X Dehumanization (Childlike)
Before we move on, let's take a gander at the dependent variables. Does there seem to be a relationship between dehumanization and *Support for establishing an Indigenous Peoples' Day*? 

```{r dv5cor, include = T, echo = F}
dv5cor <- dfdehumanDV %>%
  dplyr::select(SubjectNumber, Create_IPD, DH5_W_Childlike, DH5_N_Childlike)

dv5cor.lng <- melt(dv5cor, id=c("SubjectNumber", "Create_IPD"), variable.name = "Group", value.name="Rating")

ggplot(dv5cor.lng, aes(x= Rating, y = Create_IPD, color = Group, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Dehumanization (0-100)") +
  ylab("Support for Indigenous Peoples' Day") +
  labs(color='Dehumanization Measure') +
  scale_y_continuous(limits = c(0, NA))

#lm1 <- lm(No_Columbus ~ Rating + Group + Rating:Group, dv4cor.lng)
#summary(lm1)
```
`**Keep in mind while looking at this graph that low scores on the dehumanization measure mean that participants are dehumanizing the group` **more**.


###Model: Indigenous Peoples' Day ~ Childlike Measures

Here is the Childlike model uncentered:
```{r}
lm14 <- lm(Create_IPD ~ DH5_N_Childlike + DH5_W_Childlike + DH5_N_Childlike*DH5_W_Childlike, dv5cor)
summary(lm14)
```

...and here it is centered:
```{r}
lm15 <- lm(Create_IPD ~ scale(DH5_N_Childlike,scale=F) + scale(DH5_W_Childlike,scale=F) + scale(DH5_N_Childlike,scale=F)*scale(DH5_W_Childlike,scale=F), dv5cor)
summary(lm15)
```


##Dependent Variables: Indigenous Peoples' Day X Dehumanization (Civilized)
Before we move on, let's take a gander at the dependent variables. Does there seem to be a relationship between dehumanization and *Support for establishing an Indegenous Peoples' Day*? 

```{r dv5cor2, include = T, echo = F}
dv5cor2 <- dfdehumanDV %>%
  dplyr::select(SubjectNumber, Create_IPD, DH2_N_Civilized)

dv5cor2.lng <- melt(dv5cor2, id=c("SubjectNumber", "Create_IPD"), variable.name = "Group", value.name="Rating")

ggplot(dv5cor2.lng, aes(x= Rating, y = Create_IPD, color = Group, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Civilized") +
  ylab("Support for Indigenous Peoples' Day") +
  labs(color='Dehumanization Measure') +
  scale_y_continuous(limits = c(0, NA))

#lm1 <- lm(No_Columbus ~ Rating + Group + Rating:Group, dv4cor.lng)
#summary(lm1)
```
`**Keep in mind while looking at this graph that low scores on the dehumanization measure mean that participants are dehumanizing the group` **more**.


###Model: Indigenous Peoples' Day ~ Civilized Measures

Here is the Civilized model uncentered:
```{r}
lm16 <- lm(Create_IPD ~ DH2_N_Civilized, dv5cor2)
summary(lm16)
```

...and here it is centered:
```{r}
lm17 <- lm(Create_IPD ~ scale(DH2_N_Civilized,scale=F), dv5cor2)
summary(lm17)
```


##Dependent Variables: Side by Sides
We can also look at both of these groups side by side:

```{r, include = T, echo = F}
ggplot(dv4cor.lng, aes(x= Rating, y = No_Columbus, color = Group, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T, color = "black") +
  xlab("Dehumanization (0-100)") +
  ylab("Support for No Columbus Day") +
  labs(color='Dehumanized Group') +
  facet_wrap(~ Group) +
  scale_y_continuous(limits = c(0, NA))

```
<br></br>
and...
<br></br>
```{r, include = T, echo = F}
ggplot(dv5cor.lng, aes(x= Rating, y = Create_IPD, color = Group, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T, color = "black") +
  xlab("Dehumanization (0-100)") +
  ylab("Support for IPD") +
  labs(color='Dehumanized Group') +
  facet_wrap(~ Group) +
  scale_y_continuous(limits = c(0, NA))
```


##Dependent Variables: Digging a Little Deeper

For Civilized
```{r, include = T, echo = F}
dv4and5cor2 <- dfdehumanDV %>%
  dplyr::select(SubjectNumber, Create_IPD, No_Columbus, DH2_N_Civilized)

dv4and5cor2.lng <- melt(dv4and5cor2, id=c("SubjectNumber", "DH2_N_Civilized"), variable.name = "Holiday_Support", value.name="Rating")

dv4and5cor2.lng.cen <- dv4and5cor2.lng
dv4and5cor2.lng.cen$DH2_N_Civilized <- scale(dv4and5cor2.lng.cen$DH2_N_Civilized, scale = F)
#dv4and5cor2.lng.cen$Rating <- scale(dv4and5cor2.lng.cen$Rating, scale = F)

lm3 <- lm(Rating ~ DH2_N_Civilized+ Holiday_Support + DH2_N_Civilized:Holiday_Support, dv4and5cor2.lng.cen)
summary(lm3)
```

For Childlike
```{r, include = T, echo = F}
dv4and5cor <- dfdehumanDV %>%
  dplyr::select(SubjectNumber, Create_IPD, No_Columbus, DH5_N_Childlike)

dv4and5cor.lng <- melt(dv4and5cor, id=c("SubjectNumber", "DH5_N_Childlike"), variable.name = "Holiday_Support", value.name="Rating")

dv4and5cor.lng.cen <- dv4and5cor.lng
dv4and5cor.lng.cen$DH5_N_Childlike <- scale(dv4and5cor.lng.cen$DH5_N_Childlike, scale = F)
#dv4and5cor.lng.cen$Rating <- scale(dv4and5cor.lng.cen$Rating, scale = F)

lm9 <- lm(Rating ~ DH5_N_Childlike + Holiday_Support + DH5_N_Childlike:Holiday_Support, dv4and5cor.lng.cen)
summary(lm9)
```


#Exploratory Analysis
Let's dig into some of the demographic information in this subset of the data.


##Race
First let's look at the frequency of our different racial groups

```{r race1, include = T, echo = F}
Race.obj <- describe(dfdehumanDV$Race)
Race.obj <- Race.obj$values
Race.bars <- as.vector(Race.obj$frequency)
names(Race.bars) <- Race.obj$value
pander(Race.bars)

colors <- c("red", "yellow", "green", "violet", "orange", "blue", "pink", "cyan") 
barplot(Race.bars, col=colors)
```

Since our data skews toward **Asian**, **Black**, **White**, and **Latino** let's use these groups in future analysis. 


###Race X Support for Abolishing Columbus Day
First off, let's look at how our different racial groups answered the question about Columbus Day.

```{r bardv1, include = T, echo = F}
racialgroups <- c("Asian", "Black", "White", "Latino")

dfdehumanDV.race <- dfdehumanDV %>%
  filter(Race %in% racialgroups)

dfdehumanrace.c <- summarySE(data=dfdehumanDV.race, measurevar="No_Columbus", groupvars=c("Race"))

ggplot(dfdehumanrace.c, aes(x=Race, y=No_Columbus, fill=Race)) +
  geom_bar(position=position_dodge(), stat="identity",
           colour="black", # Use black outlines,
           size=.3) +      # Thinner lines
  geom_errorbar(aes(ymin=No_Columbus-ci, ymax=No_Columbus+ci),
                size=.3,    # Thinner lines
                width=.2,
                position=position_dodge(.9)) +
  xlab("Participant Race") +
  ylab("Support for Abolishing Columbus Day") +
  scale_y_continuous(limits = c(0,7)) +
  ggtitle("Do Different Racial Groups Support\n Removing Columbus Day Equally?") +
  theme_bw()
```


###Race X Support for Creating an Indigenous Peoples' Day
Next let's see how these groups answered the question about Indigenous Peoples' Day

```{r bardv2, include = T, echo = F}
dfdehumanrace.i <- summarySE(data=dfdehumanDV.race, measurevar="Create_IPD", groupvars=c("Race"))

ggplot(dfdehumanrace.i, aes(x=Race, y=Create_IPD, fill=Race)) +
  geom_bar(position=position_dodge(), stat="identity",
           colour="black", # Use black outlines,
           size=.3) +      # Thinner lines
  geom_errorbar(aes(ymin=Create_IPD-ci, ymax=Create_IPD+ci),
                size=.3,    # Thinner lines
                width=.2,
                position=position_dodge(.9)) +
  xlab("Participant Race") +
  ylab("Support for Creating IPD") +
  scale_y_continuous(limits = c(0,7)) +
  ggtitle("Do Different Racial Groups Support\n Creating an Indigenous Peoples' Day Equally?") +
  theme_bw()
```


###Race X Measures of Dehumanization: Civilized
For the next set of graphs let's revisit the question of dehumanization. What we're interested in here is whether or not responses to the questions of dehumanization differed by racial group. 

```{r racedhumanw,include=T,echo=F}
dfdehumanrace.civilized <- summarySE(data=dfdehumanDV.race, measurevar="DH2_N_Civilized", groupvars=c("Race"), na.rm = T)

pander(dfdehumanrace.civilized)

ggplot(dfdehumanrace.civilized, aes(x=Race, y=DH2_N_Civilized, fill=Race)) +
  geom_bar(position=position_dodge(), stat="identity",
           colour="black", # Use black outlines,
           size=.3) +      # Thinner lines
  geom_errorbar(aes(ymin=DH2_N_Civilized-ci, ymax=DH2_N_Civilized+ci),
                size=.3,    # Thinner lines
                width=.2,
                position=position_dodge(.9)) +
  xlab("Participant Race") +
  ylab("Measure of Attitudes Toward Natives: Civilized (0-100)") +
  scale_y_continuous(limits = c(0,100)) +
  ggtitle("Do Different Racial Groups\n Have Similar Attitudes Toward Natives?") +
  theme_bw()

aov1 <- aov(DH2_N_Civilized ~ Race, dfdehumanDV.race)
summary(aov1)
TukeyHSD(aov1)
```
`This analysis is done via One way ANOVA using ratings of how civilized Natives are as the DV`


###Race X Measures of Dehumanization: Childlike
Now let's look at those same tables and bar graphs for **ratings of how childlike Natives are**:

```{r racedhumann,include=T,echo=F}
dfdehumanrace.childlike <- summarySE(data=dfdehumanDV.race, measurevar="DH5_N_Childlike", groupvars=c("Race"), na.rm = T)

pander(dfdehumanrace.childlike)

ggplot(dfdehumanrace.childlike, aes(x=Race, y=DH5_N_Childlike, fill=Race)) +
  geom_bar(position=position_dodge(), stat="identity",
           colour="black", # Use black outlines,
           size=.3) +      # Thinner lines
  geom_errorbar(aes(ymin=DH5_N_Childlike-ci, ymax=DH5_N_Childlike+ci),
                size=.3,    # Thinner lines
                width=.2,
                position=position_dodge(.9)) +
  xlab("Participant Race") +
  ylab("Measure of Attitudes toward Natives: Childlike (0-100)") +
  scale_y_continuous(limits = c(0,100)) +
  ggtitle("Do Different Racial Groups\n Have Similar Attitudes Toward Natives?") +
  theme_bw()

aov2 <- aov(DH5_N_Childlike ~ Race, dfdehumanDV.race)
summary(aov2)
TukeyHSD(aov2)
```
`This analysis is done via One way ANOVA using Dehumanization of Natives as the DV`


###Dehumanization and Holidays X Race: Civilized
Now, we'll revisit the relationship between dehumanizing whites and support for the two holidays, this time broken down by race.


First **Columbus Day**:

```{r holiday1dvracecivil, include = T, echo = F}
ggplot(dfdehumanDV.race, aes(x= DH2_N_Civilized, y = No_Columbus)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Percptions of Natives: Civilized (0-100)") +
  ylab("Support for Abolishing Columbus Day") +
  #labs(color='Race of\nParticipant') +
  facet_wrap(~ Race) +
  scale_y_continuous(limits = c(0, NA))
```

Then **Indigenous Peoples' Day**:

```{r holiday2dvracecivil, include = T, echo = F}
ggplot(dfdehumanDV.race, aes(x= DH2_N_Civilized, y = Create_IPD)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Percptions of Natives: Civilized (0-100)") +
  ylab("Support for Creating Indigenous Peoples' Day") +
  #labs(color='Race of\nParticipant') +
  facet_wrap(~ Race) +
  scale_y_continuous(limits = c(0, NA))
```


###Dehumanization and Holidays X Race: Childlike
Now, we'll revisit the relationship between dehumanizing whites and support for the two holidays, this time broken down by race.


First **Columbus Day**:

```{r holiday1dvracechild, include = T, echo = F}
ggplot(dfdehumanDV.race, aes(x= DH5_N_Childlike, y = No_Columbus)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Percptions of Natives: Childlike (0-100)") +
  ylab("Support for Abolishing Columbus Day") +
  #labs(color='Race of\nParticipant') +
  facet_wrap(~ Race) +
  scale_y_continuous(limits = c(0, NA))
```

Then **Indigenous Peoples' Day**:

```{r holiday2dvracechild, include = T, echo = F}
ggplot(dfdehumanDV.race, aes(x= DH5_N_Childlike, y = Create_IPD)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T) +
  xlab("Percptions of Natives: Childlike (0-100)") +
  ylab("Support for Creating Indigenous Peoples' Day") +
  #labs(color='Race of\nParticipant') +
  facet_wrap(~ Race) +
  scale_y_continuous(limits = c(0, NA))
```


##Stereotypes in detail
Now we're going to take the opportunity to drill down a bit into the question of Native Stereotypes.

This time we're going to pull the stereotype of Natives as **Childlike** as well as the stereotype of Natives as **Uncivilized**. 

The way I'm going to do this is to pull both measures out of the dehumanization composite score and look at their effects on our DVs separately. To test this statistically we'll place them into linear models together with the composite.

Let's begin!

###Childlike
This first graph will show us regression lines for each of our 4 measures of dehumanization and their relationship with Support for abolishing Columbus Day

```{r stereotype1, include = T, echo = F}
cols1 <- c(1, 3:4, 6:20)
cols2 <- c(21, 23:24, 26:40)

dfdehumanDV.stereotypes <- dfdehumanDV %>% 
  mutate(White_Dehumanize = rowMeans(dfdehumanDV[,cols1]))
dfdehumanDV.stereotypes <- dfdehumanDV %>% 
  mutate(Native_Dehumanize = rowMeans(dfdehumanDV[,cols2]))

dvstereotypes <- dfdehumanDV.stereotypes %>%
  dplyr::select(SubjectNumber, No_Columbus, White_Dehumanize, Native_Dehumanize, DH2_W_Civilized, DH5_W_Childlike, DH2_N_Civilized, DH5_N_Childlike)

dvstereotypes.child.c <- dfdehumanDV.stereotypes %>%
  dplyr::select(SubjectNumber, No_Columbus, White_Dehumanize, Native_Dehumanize, DH5_W_Childlike, DH5_N_Childlike)

dvstereotypes.child.i <- dfdehumanDV.stereotypes %>%
  dplyr::select(SubjectNumber, Create_IPD, White_Dehumanize, Native_Dehumanize, DH5_W_Childlike, DH5_N_Childlike)

dvstereotypes.civil.c <- dfdehumanDV.stereotypes %>%
  dplyr::select(SubjectNumber, No_Columbus, White_Dehumanize, Native_Dehumanize, DH2_W_Civilized, DH2_N_Civilized)

dvstereotypes.civil.i <- dfdehumanDV.stereotypes %>%
  dplyr::select(SubjectNumber, Create_IPD, White_Dehumanize, Native_Dehumanize, DH2_W_Civilized, DH2_N_Civilized)

dvstereotypes.child.c.lng <- melt(dvstereotypes.child.c, id=c("SubjectNumber", "No_Columbus"), variable.name = "Group", value.name="Rating")

ggplot(dvstereotypes.child.c.lng, aes(x= Rating, y = No_Columbus, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T, aes(color = Group)) +
  xlab("Dehumanization (0-100)") +
  ylab("Support for No Columbus Day") +
  labs(color='Dehumanization\nMeasure') +
  scale_y_continuous(limits = c(0, NA))

psych::describe(dvstereotypes.child.c)

lm5 <- lm(scale(No_Columbus, scale=F) ~ White_Dehumanize + Native_Dehumanize + DH5_W_Childlike + DH5_N_Childlike, dvstereotypes.child.c)
summary(lm5)
```

And we'll do one for Indigenous Peoples' Day as well:

```{r stereotype2, include = T, echo = F}
dvstereotypes.child.i.lng <- melt(dvstereotypes.child.i, id=c("SubjectNumber", "Create_IPD"), variable.name = "Group", value.name="Rating")

ggplot(dvstereotypes.child.i.lng, aes(x= Rating, y = Create_IPD, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T, aes(color = Group)) +
  xlab("Dehumanization (0-100)") +
  ylab("Support for Creating IPD") +
  labs(color='Dehumanization\nMeasure') +
  scale_y_continuous(limits = c(0, NA))

psych::describe(dvstereotypes.child.i)

lm6 <- lm(scale(Create_IPD, scale=F) ~ White_Dehumanize + Native_Dehumanize + DH5_W_Childlike + DH5_N_Childlike, dvstereotypes.child.i)
summary(lm6)
```

###Civilized
Now we'll take a look at stereotypes about being civilized using the same methods as before:

```{r stereotype3, include = T, echo = F}
dvstereotypes.civil.c.lng <- melt(dvstereotypes.civil.c, id=c("SubjectNumber", "No_Columbus"), variable.name = "Group", value.name="Rating")

ggplot(dvstereotypes.civil.c.lng, aes(x= Rating, y = No_Columbus, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T, aes(color = Group)) +
  xlab("Dehumanization (0-100)") +
  ylab("Support for No Columbus Day") +
  labs(color='Dehumanization\nMeasure') +
  scale_y_continuous(limits = c(0, NA))

psych::describe(dvstereotypes.civil.c)

lm7 <- lm(scale(No_Columbus, scale=F) ~ White_Dehumanize + Native_Dehumanize + DH2_W_Civilized + DH2_N_Civilized, dvstereotypes.civil.c)
summary(lm7)
```

And we'll do one for Indigenous Peoples' Day as well:

```{r stereotype4, include = T, echo = F}
dvstereotypes.civil.i.lng <- melt(dvstereotypes.civil.i, id=c("SubjectNumber", "Create_IPD"), variable.name = "Group", value.name="Rating")

ggplot(dvstereotypes.civil.i.lng, aes(x= Rating, y = Create_IPD, group = Group)) +
  geom_point(position = position_jitter(width = 0.25)) +
  geom_smooth(stat = "smooth", position = "identity", method = "lm", se = T, na.rm = T, aes(color = Group)) +
  xlab("Dehumanization (0-100)") +
  ylab("Support for Creating IPD") +
  labs(color='Dehumanization\nMeasure') +
  scale_y_continuous(limits = c(0, NA))

psych::describe(dvstereotypes.civil.i)

lm8 <- lm(scale(Create_IPD, scale=F) ~ White_Dehumanize + Native_Dehumanize + DH2_W_Civilized + DH2_N_Civilized, dvstereotypes.civil.i)
summary(lm8)
```

The story here seems to be that in the middle, when we're talking about the average level of dehumanization, people are more or less treating the civilized question like they treat the other measures of dehumanization. However, when it comes to perceptions of Whites and Natives as *childlike* something else starts happening, particularly at the extremes. Whether there is a story there for These two measure in particular is difficult to say. 

####Childlike and Civilized by Race
Let's look at these measures broken down by race and then by education level:

```{r dehumanbreadown1, include=T,echo=F}
dvstereotypes.race <- dfdehumanDV.stereotypes %>%
  dplyr::select(SubjectNumber, White_Dehumanize, Native_Dehumanize, DH2_W_Civilized, DH2_N_Civilized, DH5_W_Childlike, DH5_N_Childlike, Race)

dvstereotypes.race <- dvstereotypes.race %>%
  filter(Race %in% racialgroups)

dvstereotypes.race.lng <- melt(dvstereotypes.race, id=c("SubjectNumber", "Race"), variable.name = "Group", value.name="Rating")

dvstereotypes.race.lng.c <- summarySE(dvstereotypes.race.lng, measurevar="Rating", groupvars=c("Race","Group"), na.rm = T)

ggplot(dvstereotypes.race.lng.c, aes(factor(Group), Rating, fill = Race)) +
  geom_bar(stat="identity", position = "dodge") + 
  geom_errorbar(aes(ymin=Rating-se, ymax=Rating+se),
                size=.3,    # Thinner lines
                width=.2,
                position=position_dodge(.9)) +
  xlab("Dehumanization Measure") +
  ggtitle("Dehumanization Measures by Race") +
  scale_fill_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 45, vjust=0.75, hjust=1))

aov4 <- aov(Rating ~ Group + Race + Group*Race, dvstereotypes.race.lng)
summary(aov4)
#TukeyHSD(aov4)
```

And in case we haven't done it, here's the measure's side by side without separating for race:

```{r}
dvstereotypes.lng.c <- summarySE(dvstereotypes.race.lng, measurevar="Rating", groupvars=c("Group"), na.rm = T)

ggplot(dvstereotypes.lng.c, aes(factor(Group), Rating)) +
  geom_bar(stat="identity", position = "dodge") + 
  geom_errorbar(aes(ymin=Rating-se, ymax=Rating+se),
                size=.3,    # Thinner lines
                width=.2,
                position=position_dodge(.9)) +
  xlab("Dehumanization Measure") +
  ggtitle("Dehumanization Measures") +
  scale_fill_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 45, vjust=0.75, hjust=1))

aov5 <- aov(Rating ~ Group, dvstereotypes.race.lng)
summary(aov5)
TukeyHSD(aov5)
```

What we end up with is several possible stories. The big picture seems to be that in some cases it is the measure that is differentiating and other times the race of the participant seems to be driving differences, particularly in our civilized and childlike measures.


####Childlike and Civilized by Education
Now, let's take a bit of a left turn and introduce another wrinkle into this analysis. How do these things break down by education level. For the sake of argument we'll look just at *college educated* versus those who are *not college educated*.

```{r dehumanbreadown2, include=T,echo=F}
dvstereotypes.edu <- dfdehumanDV.stereotypes %>%
  dplyr::select(SubjectNumber, White_Dehumanize, Native_Dehumanize, DH2_W_Civilized, DH2_N_Civilized, DH5_W_Childlike, DH5_N_Childlike, College)

dvstereotypes.edu.lng <- melt(dvstereotypes.edu, id=c("SubjectNumber", "College"), variable.name = "Group", value.name="Rating")

dvstereotypes.edu.lng.c <- summarySE(dvstereotypes.edu.lng, measurevar="Rating", groupvars=c("College","Group"), na.rm=T)

dvstereotypes.edu.lng.c <- dvstereotypes.edu.lng.c[-13:-18,]

ggplot(dvstereotypes.edu.lng.c, aes(factor(Group), Rating, fill = College)) +
  geom_bar(stat="identity", position = "dodge") + 
  geom_errorbar(aes(ymin=Rating-se, ymax=Rating+se),
                size=.3,    # Thinner lines
                width=.2,
                position=position_dodge(.9)) +
  xlab("Dehumanization Measure") +
  ggtitle("Dehumanization Measures by Education Level") +
  scale_fill_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 45, vjust=0.75, hjust=1))

aov6 <- aov(Rating ~ Group + College + Group*College, dvstereotypes.edu.lng)
summary(aov6)
#TukeyHSD(aov6)
```

A simple interaction plot will show us these effects in a different form:
```{r}
dvstereotypes.edu.q <- dfdehumanDV.stereotypes %>%
  dplyr::select(White_Dehumanize, Native_Dehumanize, DH2_W_Civilized, DH2_N_Civilized, DH5_W_Childlike, DH5_N_Childlike, College)

dvstereotypes.edu.q.lng <- melt(dvstereotypes.edu.q, id=c("College"), variable.name = "Group", value.name="Rating", na.rm = T)

interaction.plot(x.factor     = dvstereotypes.edu.q.lng$College,
                 trace.factor = dvstereotypes.edu.q.lng$Group, 
                 response     = dvstereotypes.edu.q.lng$Rating, 
                 fun = mean,
                 type="b",
                 col=c("black","red", "orange", "blue", "green", "purple"),  ### Colors for levels of trace var.
                 pch=c(19, 17, 15, 13, 11, 9),             ### Symbols for levels of trace var.
                 fixed=TRUE,                    ### Order by factor order in data
                 leg.bty = "o")
```

#Miscellaneous
This will be where we put other questions and answers that we have.

##External Motivation to Appear Non-Prejudiced
```{r emp, include=T}
emp_sd <- sd(dfdehumanDV$EMP_comp, na.rm=T)

dfdehumanDV <- dfdehumanDV %>%
  mutate(EMP_low = dfdehumanDV[,62]-emp_sd)
dfdehumanDV <- dfdehumanDV %>%
  mutate(EMP_high = dfdehumanDV[,62]+emp_sd)

emp.anal <- dfdehumanDV %>%
  dplyr::select(DH1_W_Responsible, DH2_W_Civilized, DH3_W_Moral, DH4_W_Polite, DH5_W_Childlike, DH6_W_Rational, DH7_W_Warm, DH8_W_Agentic, DH9_W_Refined, DH10_W_Lacking_Culture, `DH11_W_Lacking_Self-restraint`, DH12_W_Instinctual, DH13_W_Mature, DH14_W_Stoic, DH15_W_Emotionally_Responsive, DH16_W_Cold, DH17_W_Open, DH18_W_Rigid, DH19_W_Passive, DH20_W_Superficial, DH1_N_Responsible, DH2_N_Civilized, DH3_N_Moral, DH4_N_Polite, DH5_N_Childlike, DH6_N_Rational, DH7_N_Warm, DH8_N_Agentic, DH9_N_Refined, DH10_N_Lacking_Culture, `DH11_N_Lacking_Self-restraint`, DH12_N_Instinctual, DH13_N_Mature, DH14_N_Stoic, DH15_N_Emotionally_Responsive, DH16_N_Cold, DH17_N_Open, DH18_N_Rigid, DH19_N_Passive, DH20_N_Superficial, EMP_comp)

emp.anal.lng <- melt(emp.anal, id=c("DH1_W_Responsible", "DH2_W_Civilized", "DH3_W_Moral", "DH4_W_Polite", "DH5_W_Childlike", "DH6_W_Rational", "DH7_W_Warm", "DH8_W_Agentic", "DH9_W_Refined", "DH10_W_Lacking_Culture", "DH11_W_Lacking_Self-restraint", "DH12_W_Instinctual", "DH13_W_Mature", "DH14_W_Stoic", "DH15_W_Emotionally_Responsive", "DH16_W_Cold", "DH17_W_Open", "DH18_W_Rigid", "DH19_W_Passive", "DH20_W_Superficial", "DH1_N_Responsible", "DH2_N_Civilized", "DH3_N_Moral", "DH4_N_Polite", "DH5_N_Childlike", "DH6_N_Rational", "DH7_N_Warm", "DH8_N_Agentic", "DH9_N_Refined", "DH10_N_Lacking_Culture", "DH11_N_Lacking_Self-restraint", "DH12_N_Instinctual", "DH13_N_Mature", "DH14_N_Stoic", "DH15_N_Emotionally_Responsive", "DH16_N_Cold", "DH17_N_Open", "DH18_N_Rigid", "DH19_N_Passive", "DH20_N_Superficial"), variable.name = "EMP", value.name="Mean Score")       

test <- summarySE(data=emp.anal.lng, measurevar="Mean Score", groupvars=c("DH1_W_Responsible", "DH2_W_Civilized", "DH3_W_Moral", "DH4_W_Polite", "DH5_W_Childlike", "DH6_W_Rational", "DH7_W_Warm", "DH8_W_Agentic", "DH9_W_Refined", "DH10_W_Lacking_Culture", "`DH11_W_Lacking_Self-restraint`", "DH12_W_Instinctual", "DH13_W_Mature", "DH14_W_Stoic", "DH15_W_Emotionally_Responsive", "DH16_W_Cold", "DH17_W_Open", "DH18_W_Rigid", "DH19_W_Passive", "DH20_W_Superficial", "DH1_N_Responsible", "DH2_N_Civilized", "DH3_N_Moral", "DH4_N_Polite", "DH5_N_Childlike", "DH6_N_Rational", "DH7_N_Warm", "DH8_N_Agentic", "DH9_N_Refined", "DH10_N_Lacking_Culture", "`DH11_N_Lacking_Self-restraint`", "DH12_N_Instinctual", "DH13_N_Mature", "DH14_N_Stoic", "DH15_N_Emotionally_Responsive", "DH16_N_Cold", "DH17_N_Open", "DH18_N_Rigid", "DH19_N_Passive", "DH20_N_Superficial","EMP"), na.rm = T)

#emp.anal.lng <- melt(emp.anal, id=c("EMP_low", "EMP_cent", "EMP_high"), variable.name = "Measure", value.name="Rating")

#emp.anal.lng.c <- summarySE(data=emp.anal.lng, measurevar="Rating", groupvars=c("Measure","EMP_low", "EMP_cent", "EMP_high"), na.rm = T)

emp.table <- psych::describeBy(emp.anal.lng, group = "EMP")
pander(emp.table)

```
